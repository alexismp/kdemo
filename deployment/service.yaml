apiVersion: serving.knative.dev/v1alpha1
kind: Service
metadata:
  name: kdemo
spec:
  runLatest:
    configuration:
      revisionTemplate:
        spec:
          container:
            image: gcr.io/cloudylabs-public/kdemo:0.2.5
            env:
              - name: RELEASE
                value: "v0.2.2-manual"
              - name: KLOGO_SERVICE_URL
                value: "http://klogo.demo.svc.cluster.local"
              - name: KUSER_SERVICE_URL
                value: "http://kuser.demo.svc.cluster.local"
              - name: FORCE_HTTPS
                value: "yes"
              - name: OAUTH_CLIENT_ID
                valueFrom:
                  secretKeyRef:
                    name: kdemo
                    key: OAUTH_CLIENT_ID
              - name: OAUTH_CLIENT_SECRET
                valueFrom:
                  secretKeyRef:
                    name: kdemo
                    key: OAUTH_CLIENT_SECRET
              - name: GCP_PROJECT_ID
                valueFrom:
                  configMapKeyRef:
                    name: global-config
                    key: project
